!function(){"use strict";var t,e={};t="undefined"!=typeof module?module.exports=e:function(){return this||(1,eval)("this")}(),t.xblocks=e,function(t){t.merge=function(e,n){return"object"!==t.type(e)&&(e={}),Object.keys(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}),e},t.type=function(t){return{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},t.noop=function(){},t.equals=function(e,n){if(e===n)return!0;if(!(e instanceof Object&&n instanceof Object))return!1;if(e.constructor!==n.constructor)return!1;for(var o in e)if(e.hasOwnProperty(o)){if(!n.hasOwnProperty(o))return!1;if(e[o]!==n[o]){if("object"!=typeof e[o])return!1;if(!t.equals(e[o],n[o]))return!1}}for(o in n)if(n.hasOwnProperty(o)&&!e.hasOwnProperty(o))return!1;return!0},t.isEmptyObject=function(e){if("object"!==t.type(e))return!0;for(var n in e)if(e.hasOwnProperty(n))return!1;return!0},t.filterObject=function(t,e){var n={};return Object.keys(t).forEach(function(o){var r=Object.getOwnPropertyDescriptor(t,o);e&&e(o,r)&&Object.defineProperty(n,o,r)}),n},t.mapObject=function(e,n){var o={};return Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r),s=n&&n(r,i);"object"===t.type(s)&&Object.defineProperty(o,s.name,s.descr)}),o}}(e),function(t){t.dom={},t.dom.attrs={},t.dom.attrs.ARRTS_BOOLEAN=["checked","selected","disabled","readonly","multiple","ismap","defer","autofocus"],t.dom.attrs.getRealValue=function(e,n){return"true"===n||"false"===n||-1!==t.dom.attrs.ARRTS_BOOLEAN.indexOf(e)?""===n||e===n||"true"===n:n},t.dom.attrs.toObject=function(e){if(1!==e.nodeType)return{};var n={};return Array.prototype.forEach.call(e.attributes,function(e){n[e.nodeName]=t.dom.attrs.getRealValue(e.nodeName,e.value)}),n}}(e),function(t,e){var n={};t.view={},t.view.register=function(t,o){return o.mixins=Array.isArray(o.mixins)?o.mixins:[],o.mixins.push(n),e.DOM[t]=e.createClass(o)},t.view.get=function(t){return e.DOM[t]}}(e,React),function(t,e){e.create=function(n,o){return o="object"==typeof o?o:{},o.lifecycle={created:function(){this.xblock=e.element.create(this)},removed:function(){this.xblock.destroy(),delete this.xblock}},t.register(n,o)}}(xtag,e),function(t,e,n){function o(t){this._name=t.tagName.toLowerCase(),this._node=t,this._component=null,this._observer=new MutationObserver(this._callbackMutation.bind(this)),this._init(null,this._callbackInit)}e.element={},e.element.create=function(t){return new o(t)},o.prototype._name=void 0,o.prototype._node=null,o.prototype._component=null,o.prototype._observer=null,o.prototype.destroy=function(){n.unmountComponentAtNode(this._node),this.unmount()},o.prototype.unmount=function(){this._observer.disconnect(),this._isMountedComponent()&&(this._component.unmountComponent(),this._component=null)},o.prototype.update=function(t,n){if(this._isMountedComponent()){var o=this._getNodeProps(t);if(Array.isArray(n)&&n.length){var r=this._getCurrentProps();o=e.merge(r,o),o=e.filterObject(o,function(t){return-1===n.indexOf(t)}),this._component.replaceProps(o)}else this._component.setProps(o)}},o.prototype._init=function(t,o){if(!this._isMountedComponent()){var r=e.view.get(this._name),i=this._getNodeProps(t),s=this._node.innerHTML||i.children;this._component=n.renderComponent(r(i,s),this._node,this._callbackRender.bind(this,o))}},o.prototype._repaint=function(){var t=this._getCurrentProps();this.destroy(),this._init(t,this._callbackRepaint)},o.prototype._callbackInit=function(){t.fireEvent(this._node,"xb-created")},o.prototype._callbackRepaint=function(){t.fireEvent(this._node,"xb-repaint")},o.prototype._callbackRender=function(t){this._observer.observe(this._node,{attributes:!0,childList:!0,characterData:!0,subtree:!1,attributeOldValue:!1,characterDataOldValue:!1}),t&&t.call(this)},o.prototype._callbackMutation=function(t){if(this._isMountedComponent())if(t.some(this._checkNodeChange))this._repaint();else if(t.some(this._checkAttributesChange)){var e=t.filter(this._filterAttributesRemove,this).map(this._mapAttributesName);this.update(null,e)}},o.prototype._getNodeProps=function(t){var n=e.dom.attrs.toObject(this._node);return"object"===e.type(t)&&e.merge(n,t),n},o.prototype._isMountedComponent=function(){return this._component&&this._component.isMounted()},o.prototype._getCurrentProps=function(){return this._isMountedComponent()?this._component.props:null},o.prototype._checkNodeChange=function(t){return"childList"===t.type},o.prototype._checkAttributesChange=function(t){return"attributes"===t.type},o.prototype._filterAttributesRemove=function(t){return"attributes"===t.type&&!this._node.hasAttribute(t.attributeName)},o.prototype._mapAttributesName=function(t){return t.attributeName}}(xtag,e,React)}();